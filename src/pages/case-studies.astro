---
import { getImage } from '@astrojs/image'
import Banner from '../components/Banner.astro'
import BannerText from '../components/BannerText.astro'
import Section from '../components/Section.astro'
import type { CaseStudyProps } from '../layouts/CaseStudy.astro'
import CaseStudy from '../layouts/CaseStudy.astro'
import Layout from '../layouts/Layout.astro'

const caseStudies = await Astro.glob<CaseStudyProps>(
  '../data/case-studies/*.md'
)

const caseStudiesParsed = caseStudies.sort(
  (a, b) => a.frontmatter.weight - b.frontmatter.weight
)

const caseStudiesPicture = await getImage({
  src: import('../assets/site/case-studies-banner.jpg'),
  width: 1700,
  quality: 90
}).then((img) => img.src)
---

<Layout navbar title='Case Studies'>
  <main>
    <Banner
      text='Case Studies'
      style={{
        backgroundImage: `url(${caseStudiesPicture})`
      }}
    />

    <BannerText
      title='IT projects are full of risk'
      subtitle='Make sure you choose a vendor that can deliver â€” here are some of our favourite success stories.'
    />

    <Section>
      <div class='flex flex-col gap-36 py-28'>
        {caseStudiesParsed.map((caseStudy) => (
          <CaseStudy {...caseStudy.frontmatter} />
        ))}
      </div>
    </Section>
  </main>
</Layout>
